<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¡ vs ç¾é‡‘</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#4CAF50" />
  <link rel="icon" href="icon.png">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 1rem;
    }
    .container {
      max-width: 480px;
      margin: 0 auto;
      padding: 1.5rem;
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    h2 { text-align: center; margin-bottom: 1rem; }
    label { display: block; margin: 0.5rem 0 0.2rem; font-weight: bold; }
    input, select {
      width: 100%; padding: 0.6rem; margin-bottom: 0.8rem;
      font-size: 1rem; border-radius: 8px; border: 1px solid #ccc;
    }
    button {
      width: 100%; padding: 0.8rem; font-size: 1.1rem;
      border-radius: 8px; border: none; background-color: #4CAF50;
      color: white; font-weight: bold; margin-top: 1rem;
    }
    .notice { font-size: 0.9rem; color: #4CAF50; margin-top: -0.6rem; margin-bottom: 1rem; }
    .result {
      margin-top: 1.5rem; padding: 1rem; background: #f0f0f0;
      border-radius: 8px; font-size: 1rem;
    }
  </style>
</head>
<body>
<div class="container">
  <h2>ğŸ’± å¡ vs ç¾é‡‘</h2>
  <label>å¹£åˆ¥</label>
  <select id="currency">
    <option value="JPY">æ—¥åœ“ (JPY)</option>
    <option value="KRW">éŸ“å…ƒ (KRW)</option>
    <option value="USD">ç¾å…ƒ (USD)</option>
    <option value="EUR">æ­å…ƒ (EUR)</option>
  </select>
  <label>å•†å“åƒ¹æ ¼ï¼ˆä»¥æ‰€é¸å¹£åˆ¥è¨ˆï¼‰</label>
  <input type="number" id="amount" value="10000">
  <h3>ğŸ’³ è‡ªè¨‚åŒ¯ç‡å¡ï¼ˆé›™å¹£å¡æˆ–ç¾é‡‘ï¼‰</h3>
  <label>åŒ¯ç‡</label>
  <input type="number" step="0.0001" id="dualRate" value="0.219">
  <label>å›é¥‹ç™¾åˆ†æ¯”ï¼ˆç¾é‡‘è«‹å¡« 0ï¼‰</label>
  <input type="number" step="0.1" id="dualCashback" value="1">
  <h3>ğŸ’³ ä¸€èˆ¬ä¿¡ç”¨å¡</h3>
  <label>ä¿¡ç”¨å¡åŒ¯ç‡</label>
  <input type="number" step="0.0001" id="cardRate" value="0.2225">
  <div id="rateNotice" class="notice"></div>
  <button onclick="loadRate()">é‡æ–°å–å¾—å³æ™‚åŒ¯ç‡</button>
  <label>ä¿¡ç”¨å¡å›é¥‹ç™¾åˆ†æ¯”</label>
  <input type="number" step="0.1" id="cardCashback" value="3">
  <label><input type="checkbox" id="includeFee" checked> è€ƒæ…® 1.5% æµ·å¤–æ‰‹çºŒè²»</label>
  <button onclick="calculate()">è¨ˆç®—ï¼</button>
  <div class="result" id="output"></div>
</div>
<script>
  function loadRate() {
    const currency = document.getElementById("currency").value;
    fetch("https://open.er-api.com/v6/latest/TWD")
      .then(response => response.json())
      .then(data => {
        const toTWD = 1 / data.rates[currency];
        document.getElementById("cardRate").value = toTWD.toFixed(4);
        document.getElementById("rateNotice").textContent = `å·²è‡ªå‹•è¼‰å…¥å³æ™‚åŒ¯ç‡ï¼ˆ1 ${currency} â‰ˆ ${toTWD.toFixed(4)} TWDï¼‰`;
      })
      .catch(() => {
        document.getElementById("rateNotice").textContent = "âš ï¸ ç„¡æ³•å–å¾—å³æ™‚åŒ¯ç‡ï¼Œè«‹æ‰‹å‹•è¼¸å…¥ã€‚";
      });
  }
  document.addEventListener("DOMContentLoaded", loadRate);
  document.getElementById("currency").addEventListener("change", loadRate);
  function calculate() {
    const amount = parseFloat(document.getElementById("amount").value);
    const dual = amount * parseFloat(document.getElementById("dualRate").value);
    const dualFinal = dual * (1 - parseFloat(document.getElementById("dualCashback").value) / 100);
    const cardRate = parseFloat(document.getElementById("cardRate").value);
    const cardFinalRate = document.getElementById("includeFee").checked ? cardRate * 1.015 : cardRate;
    const card = amount * cardFinalRate;
    const cardFinal = card * (1 - parseFloat(document.getElementById("cardCashback").value) / 100);
    let suggestion = "âœ… å»ºè­°ä½¿ç”¨è‡ªè¨‚åŒ¯ç‡å¡ï¼";
    if (cardFinal < dualFinal) suggestion = "âœ… å»ºè­°ä½¿ç”¨ä¸€èˆ¬ä¿¡ç”¨å¡ï¼";
    document.getElementById("output").innerHTML = `
      <strong>è‡ªè¨‚åŒ¯ç‡å¡ï¼š</strong> ${dualFinal.toFixed(2)} å…ƒ<br>
      <strong>ä¸€èˆ¬ä¿¡ç”¨å¡ï¼š</strong> ${cardFinal.toFixed(2)} å…ƒ<br><br>
      <strong>${suggestion}</strong>
    `;
  }
</script>
</body>
</html>
